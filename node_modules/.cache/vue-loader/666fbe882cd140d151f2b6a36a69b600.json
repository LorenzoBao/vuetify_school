{"remainingRequest":"G:\\x\\vuetify_school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\x\\vuetify_school\\src\\views\\Sign.vue?vue&type=style&index=0&id=9bd32b12&scoped=true&lang=css&","dependencies":[{"path":"G:\\x\\vuetify_school\\src\\views\\Sign.vue","mtime":1623497218012},{"path":"G:\\x\\vuetify_school\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\x\\vuetify_school\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"G:\\x\\vuetify_school\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"G:\\x\\vuetify_school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\x\\vuetify_school\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCiNjYXJkew0KICB0b3A6IDEwMHB4Ow0KICBtYXJnaW46IGF1dG87DQogIGJveC1zaGFkb3c6ICNjOGM5Y2MgMTBweCAxMHB4IDVweDsNCn0NCiN0ZXh0ew0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LXdyYXA6IHdyYXA7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KDQp9DQoNCg=="},{"version":3,"sources":["Sign.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Sign.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <v-card\r\n      color=\"blue-grey darken-1\"\r\n      dark\r\n      :loading=\"isUpdating\"\r\n      width=\"400\"\r\n      id=\"card\"\r\n  >\r\n    <template v-slot:progress>\r\n      <v-progress-linear\r\n          absolute\r\n          color=\"green lighten-3\"\r\n          height=\"4\"\r\n          indeterminate\r\n      ></v-progress-linear>\r\n    </template>\r\n    <v-img\r\n        height=\"300\"\r\n        src=\"../assets/dark-beach.jpg\"\r\n    >\r\n\r\n    </v-img>\r\n    <v-form>\r\n      <v-container id=\"text\">\r\n        <div style=\"width: 280px\">\r\n\r\n            <v-text-field\r\n                v-model=\"names\"\r\n                :disabled=\"isUpdating\"\r\n                class=\"text\"\r\n                filled\r\n                color=\"blue-grey lighten-2\"\r\n                label=\"用户名\"\r\n            ></v-text-field>\r\n        </div>\r\n        <div style=\"width: 280px\">\r\n\r\n            <v-text-field\r\n                v-model=\"pas\"\r\n                :disabled=\"isUpdating\"\r\n                filled\r\n                class=\"text\"\r\n                type=\"password\"\r\n                color=\"blue-grey lighten-2\"\r\n                label=\"密码\"\r\n            ></v-text-field>\r\n        </div>\r\n      </v-container>\r\n    </v-form>\r\n    <v-divider></v-divider>\r\n    <v-card-actions>\r\n\r\n      <v-spacer></v-spacer>\r\n      <v-btn\r\n          :loading=\"isUpdating\"\r\n          color=\"blue-grey darken-3\"\r\n          depressed\r\n          @click=\"submit()\"\r\n      >\r\n        <v-icon left>\r\n          mdi-update\r\n        </v-icon>\r\n        登录\r\n      </v-btn>\r\n    </v-card-actions>\r\n    <failDialogs  ref=\"failDialogs\"></failDialogs>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport {request} from \"../network/request\";\r\nimport VueCookies from 'vue-cookies'\r\nimport {getAdminInfo, getImage} from \"../network/adminApi\";\r\nimport $store from '../store'\r\nimport {ifthen} from \"../network/FN\";\r\nimport failDialogs from \"../components/HomeItem/failDialogs\";\r\n\r\n\r\nexport default {\r\nname: \"Sign\",\r\n  data(){\r\n    return{\r\n      pas: VueCookies.get('password')? VueCookies.get('password'):'',\r\n      names:  VueCookies.get('username')?VueCookies.get('username'):'',\r\n      // password: VueCookies.get('password'),\r\n      // username:VueCookies.get('username'),\r\n      isUpdating: false,\r\n    }\r\n  },\r\n  mounted() {\r\n\r\n    if(this.$store.state.Sing && this.names && this.pas){\r\n      setTimeout(()=>{\r\n        this.submit()\r\n      },1000)\r\n  }\r\n\r\n  },\r\n  components:{\r\n    failDialogs\r\n  },\r\n  methods:{\r\n  submit(){\r\n    this.$refs.failDialogs.dialog=true;\r\n    this.$refs.failDialogs.text='登录失败，请检查用户名密码或检查网络连接'\r\n    this.isUpdating=true\r\n    request({\r\n      url:'/admin/login',\r\n      method:'post',\r\n      data:{\r\n        \"password\": this.pas,\r\n        \"username\": this.names\r\n        // \"password\": '123456',\r\n        // \"username\": 'admin'\r\n      },\r\n\r\n     //\r\n    })\r\n     .then(res=>{\r\n        if(res.code===500){\r\n          this.isUpdating=false\r\n          alert('登录失败，请检查用户名密码或检查网络连接')\r\n\r\n        }\r\n       if(ifthen(res)) {\r\n         this.$store.commit(\"setToken\", res.data.token)\r\n         if (this.$store.state.token) {\r\n           alert('登录成功')\r\n           this.$store.commit('upDataSing')\r\n           VueCookies.set('username', this.names)\r\n           VueCookies.set('password', this.pas)\r\n           getImage(this.names)\r\n               .then((res) => {\r\n                   $store.commit('upDateAdminImage', res.data)\r\n                   $store.commit('upDateAdminUserName', this.names)\r\n                   }\r\n               ).catch()\r\n             getAdminInfo()\r\n                 .then(res=>{\r\n                   if(ifthen(res)) {\r\n                     $store.commit('upDateAdminInfo', res.data)\r\n                     this.$router.push('/Dashboard')\r\n                   }\r\n\r\n                 })\r\n                 .catch(()=>{\r\n                   this.$refs.failDialogs.dialog=true;this.$refs.failDialogs.text='获取个人信息失败请刷新页面'\r\n\r\n                 })\r\n\r\n\r\n         }\r\n       }\r\n      })\r\n      .catch(()=>{\r\n\r\n        this.isUpdating=false\r\n        alert('登录失败，请检查网络连接')\r\n\r\n      })\r\n\r\n   this.$router.push('/Dashboard')\r\n\r\n\r\n\r\n  }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#card{\r\n  top: 100px;\r\n  margin: auto;\r\n  box-shadow: #c8c9cc 10px 10px 5px;\r\n}\r\n#text{\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n\r\n}\r\n\r\n</style>"]}]}